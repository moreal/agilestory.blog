import{d as p,T as f,y as N}from"./hooks.module.BXRoyx2g.js";import{u as e}from"./jsxRuntime.module.BLZlUNXw.js";import"./preact.module.BYSHj7yn.js";function b(t){const a=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${a}.${l}.${r}`}function w(t){const l=t.class||t.className||"text-sm font-medium text-gray-500";return e("time",{className:l,dateTime:t.date.toISOString(),title:t.date.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"}),children:b(t.date)})}function v({post:t}){const{title:a,createdAt:l,id:r,snippet:c}=t;return e("article",{className:"group",children:e("a",{className:"block hover:text-blue-600 transition-colors duration-200",href:`${r}`,children:e("div",{className:"flex items-baseline gap-4",children:[e(w,{date:l,className:"text-sm text-gray-500 flex-shrink-0"}),e("div",{className:"flex-1 min-w-0",children:[e("h3",{className:"text-lg font-medium text-gray-900 group-hover:text-blue-600 transition-colors duration-200",children:a}),c&&e("div",{className:"mt-1 text-sm text-gray-600 search-snippet",children:e("span",{dangerouslySetInnerHTML:{__html:c}})})]})]})})})}function S(t){return t.replace(/<[^>]*>/g,"").replace(/&[^;]+;/g," ").trim()}function T(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(t,a,l=150){const r=S(t),c=r.toLowerCase(),g=a.toLowerCase(),u=c.indexOf(g);if(u===-1)return"";const n=Math.floor((l-a.length)/2),i=Math.max(0,u-n),o=Math.min(r.length,u+a.length+n);let s=r.substring(i,o);i>0&&(s="..."+s),o<r.length&&(s=s+"...");const m=T(a),h=new RegExp(`(${m})`,"gi");return s=s.replace(h,"<strong>$1</strong>"),s}function $({posts:t}){const[a,l]=p(""),[r,c]=p("no-query"),g=f(()=>t.filter(n=>n.createdAt!==null),[t]);N(()=>{const n=()=>{const s=new URLSearchParams(globalThis.location.search).get("q");l(s||"")};n(),globalThis.addEventListener("popstate",n);const i=globalThis.history.pushState;return globalThis.history.pushState=function(...o){i.apply(globalThis.history,o),n()},()=>{globalThis.removeEventListener("popstate",n),globalThis.history.pushState=i}},[]);const u=f(()=>{if(!a.trim())return c("no-query"),[];const n=a.toLowerCase(),i=[];for(const s of g){const m=s.title.toLowerCase().includes(n),h=s.body.toLowerCase().includes(n);if(m||h){let d="";if(m&&(d=y(s.title,a,100)),!d||d.length<20){const x=y(s.body,a);x&&(d=x)}i.push({id:s.id,title:s.title,createdAt:new Date(s.createdAt),snippet:d})}}i.sort((s,m)=>{const h=s.title.toLowerCase().includes(n),d=m.title.toLowerCase().includes(n);return h&&!d?-1:!h&&d?1:m.createdAt.getTime()-s.createdAt.getTime()});const o=i.slice(0,10);return o.length>0?c("success"):c("no-results"),o},[a,g]);return e("div",{className:"w-full flex justify-center",children:e("div",{className:"max-w-[680px] w-full",children:[r==="no-query"&&e("div",{className:"text-center py-16",children:e("div",{className:"max-w-md mx-auto",children:[e("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"검색을 시작해보세요"}),e("p",{className:"text-gray-600",children:"찾고 싶은 내용의 키워드를 입력해 주세요."})]})}),r==="no-results"&&e("div",{className:"text-center py-16",children:e("div",{className:"max-w-md mx-auto",children:[e("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:['"',e("span",{className:"text-blue-600",children:a}),'" 검색 결과가 없습니다']}),e("p",{className:"text-gray-600",children:"다른 검색어를 시도해 보세요."})]})}),r==="success"&&e("div",{children:[e("div",{className:"mb-8",children:[e("h2",{className:"text-lg font-medium text-gray-900 mb-1",children:['"',e("span",{className:"text-blue-600",children:a}),'" 검색 결과']}),e("p",{className:"text-sm text-gray-500",children:[u.length,"개 발견"]})]}),e("div",{className:"space-y-6",children:u.map(n=>e(v,{post:n},n.id))})]})]})})}export{$ as SearchPage};
