import{d as y,T as w,y as b}from"./hooks.module.BXRoyx2g.js";import{u as e}from"./jsxRuntime.module.BLZlUNXw.js";import"./preact.module.BYSHj7yn.js";function v(t){const a=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${a}.${c}.${l}`}function S(t){const c=t.class||t.className||"text-sm font-medium text-gray-500";return e("time",{className:c,dateTime:t.date.toISOString(),title:t.date.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"}),children:v(t.date)})}function L({post:t}){const{title:a,createdAt:c,id:l,snippet:o}=t;return e("article",{className:"group",children:e("a",{className:"block hover:text-blue-600 transition-colors duration-200",href:`${l}`,children:e("div",{className:"flex items-baseline gap-4",children:[e(S,{date:c,className:"text-sm text-gray-500 flex-shrink-0"}),e("div",{className:"flex-1 min-w-0",children:[e("h3",{className:"text-lg font-medium text-gray-900 group-hover:text-blue-600 transition-colors duration-200",children:a}),o&&e("div",{className:"mt-1 text-sm text-gray-600 search-snippet",children:e("span",{dangerouslySetInnerHTML:{__html:o}})})]})]})})})}function C(t){return t.replace(/<[^>]*>/g,"").replace(/&[^;]+;/g," ").trim()}function q(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function N(t,a,c=150){const l=C(t),o=l.toLowerCase(),h=a.toLowerCase(),u=o.indexOf(h);if(u===-1)return"";const f=Math.floor((c-a.length)/2),x=Math.max(0,u-f),n=Math.min(l.length,u+a.length+f);let r=l.substring(x,n);x>0&&(r="..."+r),n<l.length&&(r=r+"...");const i=q(a),s=new RegExp(`(${i})`,"gi");return r=r.replace(s,"<strong>$1</strong>"),r}function $({posts:t}){const[a,c]=y(""),[l,o]=y("no-query"),h=w(()=>t.filter(n=>n.createdAt!==null),[t]);b(()=>{const r=new URLSearchParams(window.location.search).get("q");r&&c(r)},[]);const u=w(()=>{if(!a.trim())return o("no-query"),[];const n=a.toLowerCase(),r=[];for(const s of h){const m=s.title.toLowerCase().includes(n),g=s.body.toLowerCase().includes(n);if(m||g){let d="";if(m&&(d=N(s.title,a,100)),!d||d.length<20){const p=N(s.body,a);p&&(d=p)}r.push({id:s.id,title:s.title,createdAt:new Date(s.createdAt),snippet:d})}}r.sort((s,m)=>{const g=s.title.toLowerCase().includes(n),d=m.title.toLowerCase().includes(n);return g&&!d?-1:!g&&d?1:m.createdAt.getTime()-s.createdAt.getTime()});const i=r.slice(0,10);return i.length>0?o("success"):o("no-results"),i},[a,h]);return e("div",{className:"w-full flex justify-center",children:e("div",{className:"max-w-[680px] w-full",children:[e("div",{className:"mb-8",children:e("form",{onSubmit:n=>{n.preventDefault();const i=new FormData(n.currentTarget).get("q");if(i){c(i.trim());const s=new URL(window.location.href);s.searchParams.set("q",i.trim()),window.history.pushState({},"",s)}},className:"flex gap-2",children:[e("input",{type:"text",name:"q",defaultValue:a,onChange:n=>{if(!n.target.value.trim()){c("");const i=new URL(window.location.href);i.searchParams.delete("q"),window.history.pushState({},"",i)}},placeholder:"검색할 키워드를 입력하세요",className:"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0}),e("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:"검색"})]})}),l==="no-query"&&e("div",{className:"text-center py-16",children:e("div",{className:"max-w-md mx-auto",children:[e("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:"검색을 시작해보세요"}),e("p",{className:"text-gray-600",children:"찾고 싶은 내용의 키워드를 입력해 주세요."})]})}),l==="no-results"&&e("div",{className:"text-center py-16",children:e("div",{className:"max-w-md mx-auto",children:[e("h2",{className:"text-xl font-medium text-gray-900 mb-2",children:['"',e("span",{className:"text-blue-600",children:a}),'" 검색 결과가 없습니다']}),e("p",{className:"text-gray-600",children:"다른 검색어를 시도해 보세요."})]})}),l==="success"&&e("div",{children:[e("div",{className:"mb-8",children:[e("h2",{className:"text-lg font-medium text-gray-900 mb-1",children:['"',e("span",{className:"text-blue-600",children:a}),'" 검색 결과']}),e("p",{className:"text-sm text-gray-500",children:[u.length,"개 발견"]})]}),e("div",{className:"space-y-6",children:u.map(n=>e(L,{post:n},n.id))})]})]})})}export{$ as SearchPage};
